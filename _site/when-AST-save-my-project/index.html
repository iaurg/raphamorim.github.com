<!doctype html>
<html lang="en">
<head>
  <title>When AST has saved my Project &mdash; Raphamorim</title>

  <!-- Meta -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  
    <meta name="twitter:description" content="For people who don’t now. I’ve created ranza for check unusable dependencies. Why? To avoid accumulation of dependencies that are not being used…. The Ranza initially was using fs module to read files and apply an regex in all data to catch all requires in that file. Working only for Nodejs projects. Well, in that time I don’t realized wich using that technique for get all requires in the file/project was a problem. Why? I’ve made a good regex. It’ve work for regular (most) cases. But regex is dump. This technicle only will work for cases who I know. So..." />
  

  <meta name="keywords" content="raphael, amorim, developer, open, javascript, python, clojure, source">

  <!-- Facebook -->
  <meta property="og:title" content="When AST has saved my Project - Raphamorim"/>
  <meta property="og:type" content="article"/>
  <meta property="og:url" content="http://raphamorim.io/when-AST-save-my-project/"/>
  <meta property="og:image" content="http://raphamorim.io/assets/images/posts/code-ast.jpg"/>
  <meta property="og:site_name" content="Raphamorim"/>
  <meta property="og:description" content="For people who don't now. I've created ranza for check unusable dependencies. Why? To avoid accumulation of dependencies that are not being used...."/>
  <meta property="fb:admins" content="100001780434348" />

  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="When AST has saved my Project - Raphamorim">

  
    <meta name="twitter:description" content="For people who don’t now. I’ve created ranza for check unusable dependencies. Why? To avoid accumulation of dependencies that are not being used…. The Ranza initially was using fs module to read files and apply an regex in all data to catch all requires in that file. Working only for Nodejs projects. Well, in that time I don’t realized wich using that technique for get all requires in the file/project was a problem. Why? I’ve made a good regex. It’ve work for regular (most) cases. But regex is dump. This technicle only will work for cases who I know. So..." />
  

  <meta name="twitter:url" content="http://raphamorim.io/when-AST-save-my-project/">
  <meta name="twitter:image" content="http://raphamorim.io/assets/images/posts/code-ast.jpg"/>

  <!-- Favicon -->
  <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon" />

  <style>
  .container,.main{position:relative}*{padding:0;margin:0;border:0;outline:0;font-size:100%;line-height:1em;list-style:none;text-decoration:none;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}div:after,li:after,ul:after{content:".";display:block;clear:both;visibility:hidden;height:0;overflow:hidden}hr{display:none}p{line-height:1.5em}b,strong{font-weight:700}body{font:normal normal 20px/1.2em Helvetica,arial,sans-serif;background:#FFF;color:#777;font-weight:300;-webkit-font-smoothing:antialiased;font-smoothing:antialiased;text-shadow:1px 1px 1px rgba(0,0,0,.004)}nav{visibility:hidden}h3{margin:40px 20px -15px;font-size:20px}.main{width:100%;margin-top:-20px;padding-top:30px}.container{margin:0 auto;width:920px;z-index:1}.bar-logo{position:absolute;font-size:24px;letter-spacing:7px;line-height:30px;color:rgba(0,0,0,.498039);font-weight:600;word-wrap:break-word;width:110px;height:110px;margin-left:25px;border-width:5px;border-style:solid;border-color:rgba(0,0,0,.498039);padding:5px 0 0 8px}#posts,.post{position:relative;width:100%}#posts{margin:40px auto 0}.post{background-color:#fff;padding:15px 20px;border-bottom:1px solid rgba(0,0,0,.0980392)}.container-topic{color:rgba(0,0,0,.1);text-align:left;margin:90px 0 30px;font-size:40px;padding:0 20px}@media only screen and (max-width:980px){.main .container,nav .container{width:95%}.main{margin-top:-50px}.post p{font-size:17px;margin-top:16px}}
  </style>
</head>
<body>


  <nav>
    <div class="container">
        <a href="/" class="bar-link">
            <div class="bar-logo">
                RAPHAMORIM
            </div>
        </a>
        <div class="bar-menu">
            <ul class="pagenav">
                <a href="/about">
                    <li>About</li>
                </a>
                <a href="/articles">
                    <li>Articles</li>
                </a>
                <a target="_blank" href="https://twitter.com/@raphamundi">
                    <li>@raphamundi</li>
                </a>
                <a href="/talks">
                    <li>Talks</li>
                </a>
            </ul>
        </div>
        <div class="nav-toggle">
            <span></span>
        </div>
    </div>
    <div id="bar-mobile-menu">
        <ul class="pagenav">
            <a href="/about">
                <li>About</li>
            </a>
            <a href="/articles">
                <li>Articles</li>
            </a>
            <a target="_blank" href="https://twitter.com/@raphamundi">
                <li>@raphamundi</li>
            </a>
            <a href="/talks">
                <li>Talks</li>
            </a>
        </ul>
    </div>
</nav>

  <div class='main'>
    <div class="container">
        <ul id="posts">
            <li class="post post-page">
                <h2 class="post-title post-page-title">When AST has saved my Project</h2>
                <span class="post-date">17 Jul • 2015</span>
                <span class="post-break"></span>

                
                    <img class="post-image" src="/assets/images/posts/code-ast.jpg">
                

                <div class="post-page-content">
                    <p>For people who don’t now. I’ve created ranza for check unusable dependencies. Why? To avoid accumulation of dependencies that are not being used….</p>

<!-- more -->

<p>The <a href="http://github/raphamorim/ranza">Ranza</a> initially was using <strong>fs</strong> module to read files and apply an regex in all data to catch all requires in that file. Working only for Nodejs projects.</p>

<p>Well, in that time I don’t realized wich using that technique for get all requires in the file/project was a problem.</p>

<h3 id="why">Why?</h3>

<p>I’ve made a good regex. It’ve work for regular (most) cases. But regex  is dump. This technicle only will work for cases who I know. So with time I realized other cases, other ways to require a dependency. And  EVERY TIME I update and improve the regex (Dear Lord, it was so much boring).</p>

<p><strong>I can’t trust in my own logic, even with tests</strong>, cause every week a discover new things, new ways to apply a require. This things made ranza unstable.</p>

<p>The time has passed and I realized: “Well, this project will never work for ES6”. That’s sucks, cause my idea for futures releases is ranza work to client-side dependencies too (like an uncss for JS).</p>

<p>So, a friend of mine tell me for use <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">Abstract Syntax Three (AST)</a> to get the requires callers. The idea is amazing, it’s solve all my problems and I can remove the regex.</p>

<p>So, I made an AST file using Reflect node module, but this module only works for ES3. This could become a problem if the source file doesn’t have colons or slashes for instance. And it won’t work for newer versions like ES4 or ES5. Aww, man!</p>

<p>Also, I wanted Ranza to be able to work for ES6, which uses import instead of require. So, I took a look in the babel-core compiler (ES6 compiler), and I came up with a solution. I could transform ES6 in ES5, then later on, I would fix issues with ES3 syntax.</p>

<p>But I found a pot of gold.</p>

<p>In babel-core exists a <strong>parser</strong> method. Which convert ES6, ES5 code syntax in AST. So I decided reuse this method in ranza and now my project is stable. I’ve no fear for using this module.</p>

<p>From now, the changes in ranza is only for improvements and bugs fixes (I guess te-hehehe) &lt;3</p>


                </div>
                <div class="post-comments">
                    <div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'raphamorim',
      disqus_url = '';

  
  disqus_url = "http://raphamorim.io/when-AST-save-my-project/";
  

  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

                </div>
            </li>
        </ul>
    </div> <!-- /content -->
  </div> <!-- /container -->

<!-- CSS -->
<link rel="stylesheet" href="/assets/css/base.min.css" type="text/css" />
<script src="/assets/js/app.js" async></script>
</body>
</html>

